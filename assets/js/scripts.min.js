!function(t){t(document).ready((function(){function e(){t(".wlfmc_wishlist_table").find('.product-checkbox input[type="checkbox"]').off("change").on("change",(function(){var e=t(this);e.parent().removeClass("checked").removeClass("unchecked").addClass(e.is(":checked")?"checked":"unchecked")})).trigger("change")}function a(){e(),o(),n(),t(document).trigger("wlfmc_init_after_ajax")}function o(){var e,a;t(".wlfmc_wishlist_table").on("change",".product-quantity :input",(function(){var o=t(this),n=o.closest("[data-row-id]"),r=n.data("row-id"),c=o.closest(".wlfmc_wishlist_table"),s=c.data("token");clearTimeout(a),n.find(".add_to_cart").attr("data-quantity",o.val()),a=setTimeout((function(){e&&e.abort(),e=t.ajax({beforeSend:function(){i(c)},complete:function(){d(c)},data:{action:wlfmc_l10n.actions.update_item_quantity,context:"frontend",product_id:r,wishlist_token:s,quantity:o.val()},method:"POST",url:wlfmc_l10n.ajax_url})}),1e3)}))}function n(){t(".copy-trigger").on("click",(function(){var e=t(".copy-target");if(e.length>0)if(e.is("input"))l()?e[0].setSelectionRange(0,9999):e.select(),document.execCommand("copy");else{var a=t("<input/>",{val:e.text(),type:"text"});t("body").append(a),l()?a[0].setSelectionRange(0,9999):a.select(),document.execCommand("copy"),a.remove()}}))}function i(e){void 0!==t.fn.block&&e.fadeTo("400","0.6").block({message:null,overlayCSS:{background:"transparent url("+wlfmc_l10n.ajax_loader_url+") no-repeat center",backgroundSize:"40px 40px",opacity:1}})}function d(e){void 0!==t.fn.unblock&&e.stop(!0).css("opacity","1").unblock()}function r(e){var a={},o=null;return e?"object"==typeof e?(o=(e=t.extend({fragments:null,s:"",container:t(document),firstLoad:!1},e)).fragments?e.fragments:e.container.find(".wishlist-fragment"),e.s&&(o=o.not("[data-fragment-ref]").add(o.filter('[data-fragment-ref="'+e.s+'"]'))),e.firstLoad&&(o=o.filter(".on-first-load"))):(o=t(".wishlist-fragment"),"string"!=typeof e&&"number"!=typeof e||(o=o.not("[data-fragment-ref]").add(o.filter('[data-fragment-ref="'+e+'"]')))):o=t(".wishlist-fragment"),o.length?(o.each((function(){var e=t(this),o=e.attr("class").split(" ").filter(t=>t.length&&"exists"!==t).join(wlfmc_l10n.fragments_index_glue);a[o]=e.data("fragment-options")})),a):null}function c(e){var o=r(e=t.extend({firstLoad:!0},e));o&&t.ajax({data:{action:wlfmc_l10n.actions.load_fragments,context:"frontend",fragments:o},method:"post",success:function(n){void 0!==n.fragments&&(s(n.fragments),a(),t(document).trigger("wlfmc_fragments_loaded",[o,n.fragments,e.firstLoad]))},url:wlfmc_l10n.ajax_url})}function s(e){t.each(e,(function(e,a){var o="."+e.split(wlfmc_l10n.fragments_index_glue).filter(t=>t.length&&"exists"!==t&&"with-count"!==t).join("."),n=t(o),i=t(a).filter(o);i.length||(i=t(a).find(o)),n.length&&i.length&&n.replaceWith(i)}))}function l(){return navigator.userAgent.match(/ipad|iphone/i)}t(document).on("wlfmc_init",(function(){var l,f,_,m=t(this),u="undefined"!=typeof wc_add_to_cart_params&&null!==wc_add_to_cart_params?wc_add_to_cart_params.cart_redirect_after_add:"";m.on("click",".add_to_wishlist",(function(e){var o=t(this),n=o.attr("data-product-id"),c=t(".add-to-wishlist-"+n),l={action:wlfmc_l10n.actions.add_to_wishlist_action,context:"frontend",add_to_wishlist:n,product_type:o.data("product-type"),wishlist_id:o.data("wishlist-id"),fragments:r(n)};if(null===t(document).triggerHandler("wlfmc_add_to_wishlist_data",[o,l])&&(l=null),e.preventDefault(),jQuery(document.body).trigger("adding_to_wishlist"),function(){if(navigator.cookieEnabled)return!0;document.cookie="cookietest=1";var t=-1!==document.cookie.indexOf("cookietest=");return document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT",t}())return t.ajax({type:"POST",url:wlfmc_l10n.ajax_url,data:l,dataType:"json",beforeSend:function(){i(o)},complete:function(){d(o)},success:function(e){var i=e.result,d=e.message,r=!0,l=e.click_behavior;if("true"===i||"exists"===i){void 0!==e.fragments&&s(e.fragments),wlfmc_l10n.multi_wishlist&&!wlfmc_l10n.hide_add_button||c.find(".wlfmc-add-button").remove();var f=t(".add-to-wishlist-"+n),_=f.find(".wlfmc-popup").attr("id");_&&(r=!1,t("#"+_).popup({closeelement:"#"+_+"_close",absolute:!1,color:"#fff",horizontal:f.find(".wlfmc-popup").data("horizontal"),vertical:f.find(".wlfmc-popup").data("vertical"),transition:"all 0.3s"}),t("#"+_).popup("show")),c.addClass("exists")}r&&toastr.success(d),"true"===i&&"add-redirect"===l&&(window.location.href=e.wishlist_url),a(),t("body").trigger("added_to_wishlist",[o,c])}}),!1;window.alert(wlfmc_l10n.labels.cookie_disabled)})),m.on("click",".wlfmc_btn_login_need",(function(t){return t.preventDefault(),toastr.error(wlfmc_l10n.labels.login_need),!1})),m.on("click",".wlfmc_wishlist_table .remove_from_wishlist",(function(e){var o,n,c,l,f,_,m,u=t(this);return e.preventDefault(),n=(o=u).parents(".wlfmc_wishlist_table"),c=o.parents("[data-row-id]"),l=c.data("row-id"),f=n.data("id"),_=n.data("token"),m={action:wlfmc_l10n.actions.remove_from_wishlist_action,context:"frontend",remove_from_wishlist:l,wishlist_id:f,wishlist_token:_,fragments:r(l)},t.ajax({beforeSend:function(){i(n)},complete:function(){d(n)},data:m,method:"post",success:function(e){void 0!==e.fragments&&s(e.fragments),a(),t("body").trigger("removed_from_wishlist",[o,c])},url:wlfmc_l10n.ajax_url}),!1})),m.on("adding_to_cart","body",(function(t,e,a){void 0!==e&&void 0!==a&&e.closest(".wlfmc_wishlist_table").length&&(a.remove_from_wishlist_after_add_to_cart=e.closest("[data-row-id]").data("row-id"),a.wishlist_id=e.closest(".wlfmc_wishlist_table").data("id"),"undefined"!=typeof wc_add_to_cart_params&&(wc_add_to_cart_params.cart_redirect_after_add=wlfmc_l10n.redirect_to_cart))})),m.on("added_to_cart","body",(function(t,e,a,o){if(void 0!==o&&o.closest(".wlfmc_wishlist_table").length){"undefined"!=typeof wc_add_to_cart_params&&(wc_add_to_cart_params.cart_redirect_after_add=u);var n=o.closest("[data-row-id]"),i=n.closest(".wishlist-fragment").data("fragment-options");o.removeClass("added"),n.find(".added_to_cart").remove(),wlfmc_l10n.remove_from_wishlist_after_add_to_cart&&i.is_user_owner&&n.remove()}})),m.on("added_to_cart","body",(function(){var e=t(".woocommerce-message");0===e.length?t("#wlfmc-wishlist-form").prepend(wlfmc_l10n.labels.added_to_cart_message):e.fadeOut(300,(function(){t(this).replaceWith(wlfmc_l10n.labels.added_to_cart_message).fadeIn()}))})),m.on("cart_page_refreshed","body",a),m.on("click",".delete_item",(function(){var e=t(this),o=e.attr("data-product-id"),n=e.data("item-id"),c=t(".add-to-wishlist-"+o),l={action:wlfmc_l10n.actions.delete_item_action,context:"frontend",item_id:n,fragments:r(o)};return t.ajax({url:wlfmc_l10n.ajax_url,data:l,dataType:"json",beforeSend:function(){i(e)},complete:function(){d(e)},method:"post",success:function(o){var n=o.fragments,i=o.message;e.closest(".wlfmc-remove-button").length||toastr.error(i),void 0!==n&&s(n),a(),t("body").trigger("removed_from_wishlist",[e,c])}}),!1})),m.on("change","#bulk_add_to_cart",(function(){var e=t(this),a=e.closest(".wlfmc_wishlist_table").find("[data-row-id]").find('input[type="checkbox"]:not(:disabled)');e.is(":checked")?a.prop("checked","checked").change():a.prop("checked",!1).change()})),m.on("submit",".wlfmc-popup-form",(function(){return!1})),m.on("found_variation",(function(e,a){var o=t(e.target).data("product_id"),n=a.variation_id,d=t(".wlfmc-add-to-wishlist").find('[data-product-id="'+o+'"]'),r=t(".wlfmc-add-to-wishlist").find('[data-original-product-id="'+o+'"]'),s=d.add(r),l=s.closest(".wishlist-fragment").filter(":visible");o&&n&&s.length&&(s.each((function(){var e,a=t(this),i=a.closest(".wlfmc-add-to-wishlist");a.attr("data-original-product-id",o),a.attr("data-product-id",n),i.length&&(void 0!==(e=i.data("fragment-options"))&&(e.product_id=n,i.data("fragment-options",e)),i.removeClass((function(t,e){return e.match(/add-to-wishlist-\S+/g).join(" ")})).addClass("add-to-wishlist-"+n).attr("data-fragment-ref",n))})),wlfmc_l10n.reload_on_found_variation&&(i(l),c({fragments:l,firstLoad:!1})))})),m.on("reset_data",(function(e){var a=t(e.target).data("product_id"),o=t('[data-original-product-id="'+a+'"]'),n=o.closest(".wishlist-fragment").filter(":visible");a&&o.length&&(o.each((function(){var e,o=t(this),n=o.closest(".wlfmc-add-to-wishlist"),i=o.attr("data-product-id");o.attr("data-product-id",a),o.attr("data-original-product-id",""),n.length&&(void 0!==(e=n.data("fragment-options"))&&(e.product_id=a,n.data("fragment-options",e)),n.removeClass("add-to-wishlist-"+i).addClass("add-to-wishlist-"+a).attr("data-fragment-ref",a))})),wlfmc_l10n.reload_on_found_variation&&(i(n),c({fragments:n,firstLoad:!1})))})),m.on("wlfmc_reload_fragments",c),m.on("wlfmc_fragments_loaded",(function(e,a,o,n){n&&t(".variations_form").find(".variations select").last().change()})),m.on("click",".wlfmc-popup-feedback .close-popup",(function(t){t.preventDefault(),close_popup()})),l=function(e,a){if(void 0!==e.classList&&e.classList.contains("wlfmc-overlay")){var o="remove"===a?"removeClass":"addClass";t("body")[o]("wlfmc-with-popup")}},f=function(t){l(t,"add")},_=function(t){l(t,"remove")},new MutationObserver((function(t){for(var e in t){var a=t[e];"childList"===a.type&&(void 0!==a.addedNodes&&a.addedNodes.forEach(f),void 0!==a.removedNodes&&a.removedNodes.forEach(_))}})).observe(document.body,{childList:!0}),o(),e(),n()})).trigger("wlfmc_init")}))}(jQuery);